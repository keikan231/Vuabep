; var adnetwork_config = [6, 1, 10000, "http://banner.adnetwork.net.vn/Ad.aspx", "http://log.adnetwork.net.vn/clickbanner.aspx", -1, -1, -1, "sa"]; var boutputstr = ""; var $vaddomain = "http://embed.adnetwork.net.vn/"; var $bud = "undefined"; var $bif = (self.location != top.location); var $bof = false; var $bmw = R2(); var $bus = O(); var $bmd = $bmw.document; var $bcu = null; var $burl = ""; var A = null; var _configB = adnetwork_config; var bss = false; var IE6 = (navigator.appVersion.indexOf('MSIE 6.0') == -1) ? false : true; var $isBallonAdLoaded = false; var $timeOut = 300; var _AdballonAds = null; var $traverseTimer = null; var $AdzoneType = null; var C = { w: { n: ["adnetwork_width"], i: [], e: [] }, h: { n: ["adnetwork_height"], i: [], e: [] }, sz: { n: ["adnetwork_sizeId"], i: [], e: [] }, i: { n: ["adnetwork_zoneId"], i: [], e: [] }, t: { n: ["adnetwork_typeId"], i: [], e: [] }, tc: { n: ["adnetwork_titleColor"], i: [], e: [] }, dc: { n: ["adnetwork_desColor"], i: [], e: [] }, bgc: { n: ["adnetwork_bgColor"], i: [], e: [] }, bdc: { n: ["adnetwork_borderColor"], i: [], e: [] }, lc: { n: ["adnetwork_linkColor"], i: [], e: [] }, cid: { n: ["adnetwork_containerid"], i: [], e: [] }, flt: { n: ["adnetwork_underfilter"], i: [], e: [] }, tlul: { n: ["adnetwork_underline"], i: [], e: [] }, zt: { n: ["adnetwork_zoneType"], i: [], e: []} }; var _adnetworkId = N("i"); function R2() { try { var cx = top.document.location; return top; } catch (err) { $bof = true; } var cwd = window; while (cwd != cwd.parent) { var cp = cwd.parent; try { var cx = cp.document.location; } catch (err) { return cwd; } cwd = cp; } return cwd; } function O() { if (!$bmw.vietad_adunits) { $bmw.vietad_adunits = []; } return $bmw.vietad_adunits; } function G() { var cw = window; var csz = { "1": [760, 90], "2": [468, 60], "3": [728, 90], "4": [950, 90], "5": [658, 60], "6": [120, 60], "7": [250, 60], "8": [120, 600], "9": [120, 240], "10": [160, 600], "11": [180, 250], "12": [250, 300], "13": [360, 190], "14": [250, 250], "15": [200, 200], "16": [336, 280], "17": [300, 250], "18": [290, 200], "19": [100, 100] }; g($bmw, _configB[8]); d(); } function g(cw, cf) { var ct = new Date(); var cs = ct.getTime(); L(cw); (!cw.vietad_data[cf]) ? cw.vietad_data[cf] = 1 : cw.vietad_data[cf]++; cw.vietad_data.t = cs; } function L(cw) { if (!cw.vietad_data) { cw.vietad_data = {}; } } function d() { var ct = new Date(); var cs = ct.getTime(); var cu = {}; cu.w = window; cu.zid = _adnetworkId; cu.t = cs; cu.zt = N('zt'); cu.tp = N('t'); cu.sz = N("sz"); cu.width = N('w'); cu.height = N('h'); cu.tc = N('tc'); cu.dc = N('dc'); cu.bgc = N('bgc'); cu.bdc = N('bdc'); cu.lc = N('lc'); cu.zt = N('zt'); if (!$bus[_adnetworkId]) { $bus[_adnetworkId] = []; } $bus[_adnetworkId].push(cu); $bcu = cu; } function V() { var ct = new Date(); var cs = ct.getTime(); var cr = true; var cw = window; var cl = $bus[_adnetworkId].length; if (cl > _configB[1]) { cr = false; } cl = $bus.length; if (cl > _configB[0]) { return false; } if ($bif) { cr = true; } return cr; } function N(ck) { var cr = null; var co = C[ck]; var cw = window; for (var i = 0; i < co.n.length; i++) { if (cw[co.n[i]]) { cr = cw[co.n[i]]; break; } } return cr; } function T(cs) { if (typeof encodeURIComponent == "function") { return encodeURIComponent(cs.toString()); } else { return S(cs.toString()); } } function p(ck, cv) { if (!ck || ck == "") return; if (!cv) cv = ""; $burl = $burl + "&" + ck + "=" + cv; } function o(ck) { p(ck, N(ck)); } function b() { var cr = R(); cr = T(cr); p("r", cr); } function f(ck, cv) { if (!ck || (!cv && cv != 0) || ck == "" || (cv == "" && typeof cv == "string")) return; $burl = $burl + "&" + ck + "=" + cv; } function R() { var cr = ""; try { cr = $bmd.referrer; } catch (err) { } if (cr == null) { cr = ""; } return cr; } function e(ck) { f(ck, N(ck)); } function Z() { p("u", T(Q())); } function W() { $bcu.i = Math.random(); var cn = "vietadtmpf" + $bcu.i; var cs = "<img name='" + cn + "' id='" + cn + "' style='width:0px;height:0px;padding:0px;margin:0px;border:0px;vertical-align:baseline;' border=0 />"; document.write(cs); } function w() { var cf = "-1"; if ($bif) { var cw = window; cf = T(cw.location.href); } f("fu", cf); } function Q() { if ($bof && $bmd.referrer) return $bmd.referrer; return $bmd.location.href; } function J() { if (typeof _adnetworkId == $bud) { _adnetworkId = ""; } if (!_adnetworkId) { _adnetworkId = ""; } $burl = "?i=" + _adnetworkId; } function c() { var ca = Math.floor(Math.random() * 10000) + 10001; try { if ($bmw.vietad_data.sid) { ca = $bmw.vietad_data.sid; } else { ca = ca - 10001; $bmw.vietad_data.sid = ca; } } catch (err) { } f("ac", ca); } function K() { if (A) return; A = {}; var cu = navigator.userAgent.toLowerCase(); A.isOpera = (cu.indexOf('opera') > -1); A.isIE = (!A.isOpera && cu.indexOf('msie') > -1); A.isFF = (!A.isOpera && !A.isIE && cu.indexOf('firefox') > -1); A.addEvent = function (o, c, h) { if (this.isIE) { o.attachEvent('on' + c, h); } else { o.addEventListener(c, h, false); } } } function H() { var ci = "vietadf" + $bcu.i; $burl = _configB[3] + $burl; $burl = $burl + "&id=" + ci; $burl = $burl.substring(0, 2048); var cs = "<iframe name='" + ci + "' id='" + ci + "' border=0 frameborder=0  marginwidth='0' marginheight='0' scrolling='no' "; var cs = cs + "style=\"width:" + adnetwork_width + "px; height:" + adnetwork_height + "px;\" "; var cs = cs + "src=\"" + $burl + "\"></iframe>"; document.write(cs); } function E() { var cf = (function () { var cu = _configB[4] + $bcu.s; document.getElementById("vietadtmpf" + $bcu.i).setAttribute("src", cu); }); A.addEvent(window, "load", cf); } function AdTrackImpression(cmp) { var url = ''; url = '?z=' + _adnetworkId; url = url + '&type=F5D58A5CFC32925D'; url = url + '&lst=' + cmp; url = url + '&Pref=' + T(Q()); var cu = _configB[4] + url; SendHttpRequest(cu); } function U() { var cm = C; var cw = window; for (var co in cm) { var cn = cm[co].n; if (cn) { for (var i = 0; i < cn.length; i++) { if (typeof cw[cn[i]] != $bud) { cw[cn[i]] = null; } } } } } function F() { K(); J(); Z(); p('w', $bcu.width); p('h', $bcu.height); p('sz', $bcu.sz); p('t', $bcu.t); p('tc', $bcu.tc); p('dc', $bcu.dc); p('bgc', $bcu.bgc); p('bdc', $bcu.bdc); p('lc', $bcu.lc); p('zt', $bcu.tp); b(); $bcu.s = $burl; try { f("dx", $bmw.vietad_data[_configB[8]]); } catch (err) { } w(); W(); c(); $bcu.q = $burl; if (parseInt($bcu.tp) == 2 || parseInt($bcu.tp) == 4) { LoadJquery(); InitAd(); } else H(); U(); } G(); if (V()) { F(); } function Adtt(s) { document.write(s); } function VadAdttCodeOther(s, width, height) { var str = '<div id="divAdBalloonAds" style="width:' + width + 'px;height:' + height + 'px; border:1px solid red;clip:rect(auto,auto,auto,auto);">' + s + '</div>'; document.write(str); document.getElementById("divAdBalloonAds").style.right = '0px'; document.getElementById("divAdBalloonAds").style.display = 'block'; } function InitAd() { if ($traverseTimer == null) $traverseTimer = (new Date()).getTime(); $burl = _configB[3] + $burl; $burl = $burl.substring(0, 2048); LoadData($burl); } function LoadData(url) { document.write("<SCRIPT LANGUAGE='Javascript' SRC='" + url + "'></SCRIPT>"); } function LoadJquery() { var html_doc = document.getElementsByTagName('head')[0]; var css_file = $vaddomain + 'adnetwork_balloon_ads.css'; var css = document.createElement('link'); css.setAttribute('rel', 'stylesheet'); css.setAttribute('type', 'text/css'); css.setAttribute('href', css_file); html_doc.appendChild(css); if (IE6 == true) { var css_file = $vaddomain + 'adnetwork_IE6.css'; var css = document.createElement('link'); css.setAttribute('rel', 'stylesheet'); css.setAttribute('type', 'text/css'); css.setAttribute('href', css_file); html_doc.appendChild(css); } else { var css_file = $vaddomain + 'adnetwork_IE7.css'; var css = document.createElement('link'); css.setAttribute('rel', 'stylesheet'); css.setAttribute('type', 'text/css'); css.setAttribute('href', css_file); html_doc.appendChild(css); } } function LoadFileExendFromVad(url, type) { var doc = document.getElementsByTagName('head')[0]; if (type = 'js') { var js = document.createElement('script'); js.setAttribute('type', 'text/javascript'); js.setAttribute('src', js_file); doc.appendChild(js); } else { var css = document.createElement('link'); css.setAttribute('rel', 'stylesheet'); css.setAttribute('type', 'text/css'); css.setAttribute('href', css_file); doc.appendChild(css); } } var statusMini = false; function AdBallonAds(impression, click, filetype, file, width, height, url, title, layoutId, top, left, min, status, zone, position) { this.Impression = impression; this.Click = click; this.FileType = filetype; this.SrcFile = file; this.Width = width; this.Height = height; this.Url = url; this.Title = title; this.LayoutId = layoutId; this.Top = top; this.Left = left; this.Min = min; this.Status = status; this.ZoneId = zone; this.Position = position; } function AdBallonAdClick(position) { var adBalloonAd = null; if (position == 'top') { adBalloonAd = window.adBallonAdT; } else { adBalloonAd = window.adBallonAdB; }; if (adBalloonAd != null) { var url = ''; url = '?z=' + _adnetworkId; url = url + '&type=2879BB7B31C03D83'; url = url + '&c=' + adBalloonAd.Click; url = url + '&url=' + adBalloonAd.Url; url = url + '&Pref=' + T(Q()); var cu = _configB[4] + url; SendHttpRequest(cu); window.open(adBalloonAd.Url); } } function AdBallonAdClose(position) { if (position == 'top') document.getElementById('divAdBalloonAdsT').style.display = 'none'; else { document.getElementById('divAdBalloonAdsB').style.display = 'none'; } } function SendHttpRequest(url) { var imgObj = document.createElement('img'); imgObj.type = 'image/gif'; imgObj.src = url; imgObj.style.display = 'none'; registerImg(imgObj); } function registerImg(obj) { try { document.getElementsByTagName("head")[0].appendChild(obj); } catch (err) { } } function AdWriteBallonAds(position) { var displayString = ''; var adBalloonAd = null; if (position == 'top') { adBalloonAd = window.adBallonAdT; } else { adBalloonAd = window.adBallonAdB; }; var isRich = false; if (adBalloonAd != null) { switch (adBalloonAd.FileType) { case 'Flash': isRich = true; if (position == 'bottom') { displayString = '<div id="divAdBalloonAdsB" style="border:0px;width:' + parseInt(adBalloonAd.Width) + 'px; height:' + parseInt(adBalloonAd.Height) + 'px">'; } else { displayString = '<div id="divAdBalloonAdsT" style="border:0px;width:' + parseInt(adBalloonAd.Width) + 'px; height:' + parseInt(adBalloonAd.Height) + 'px">'; }; displayString += '<object id="BalloonObjVad" name="BalloonObjVad" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0"  width="' + adBalloonAd.Width + '" height="' + adBalloonAd.Height + '">'; displayString += '<param name="movie" value="' + adBalloonAd.SrcFile + '">'; displayString += '<param name="quality" value="high">'; displayString += '<param name="wmode" value="opaque">'; displayString += '<param name="flashVars" value="position=' + position + '">'; displayString += '<param name="allowScriptAccess" value="always">'; displayString += '<embed name="BalloonObjVad" pluginspage="http://www.macromedia.com/go/getflashplayer"'; displayString += 'src="' + adBalloonAd.SrcFile + '"'; displayString += 'wmode="opaque"'; displayString += 'allowscriptaccess="always" quality="high" type="application/x-shockwave-flash"'; displayString += 'flashVars="position=' + position + '"'; displayString += 'width="' + adBalloonAd.Width + '" height="' + adBalloonAd.Height + '">'; displayString += '</embed>'; displayString += '</object>'; break; case 'Image': displayString += '<img style="border:0px; position:relative; z-index:0;" src="' + adBalloonAd.SrcFile + '" width="' + adBalloonAd.Width + '" height="' + adBalloonAd.Height + '">'; break; default: break; } if (isRich) { displayString += '</div> ' } document.write(displayString); } } var timeOutPopupVad; function AdShowBalloonAdsVad(position) { var adBalloonAd = null; var id = 'divAdBalloonAdsT'; if (position == 'top') { adBalloonAd = window.adBallonAdT; id = 'divAdBalloonAdsT'; } else { adBalloonAd = window.adBallonAdB; id = 'divAdBalloonAdsB'; }; if (adBalloonAd != null) { var w = '0px'; w = parseInt(adBalloonAd.Width); w = w + 'px'; var sPos = 'bottom_right'; if (sPos == 'bottom_left') { document.getElementById(id).style.left = 0; document.getElementById(id).style.display = 'block'; } else if (sPos == 'bottom_right') { document.getElementById(id).style.display = 'block'; document.getElementById(id).style.right = '0px'; } switch (parseInt(adBalloonAd.LayoutId)) { case 11: AdBallonPreExpand(position); break; case 12: AdBallonExpand(position); break; default: break; } AdTrackImpression(adBalloonAd.Impression); } } function AdBallonExpand(position) { if (position == 'top') { if (window.adBallonAdT != null) { document.getElementById("divAdBalloonAdsT").style.clip = "rect(0px " + window.adBallonAdT.Width + "px " + window.adBallonAdT.Height + "px 0px)"; } } else { if (window.adBallonAdB != null) { document.getElementById("divAdBalloonAdsB").style.clip = "rect(0px " + window.adBallonAdB.Width + "px " + window.adBallonAdB.Height + "px 0px)"; } } } function AdBallonPreExpand(position) { if (position == 'top') { if (window.adBallonAdT != null) { document.getElementById("divAdBalloonAdsT").style.clip = "rect(" + window.adBallonAdT.Top + "px " + window.adBallonAdT.Width + "px " + window.adBallonAdT.Height + "px " + window.adBallonAdT.Left + "px)"; } } else { if (window.adBallonAdB != null) { document.getElementById("divAdBalloonAdsB").style.clip = "rect(" + window.adBallonAdB.Top + "px " + window.adBallonAdB.Width + "px " + window.adBallonAdB.Height + "px " + window.adBallonAdB.Left + "px)"; } } } function AdBallonMin(position) { if (position == 'top') { if (window.adBallonAdT != null) { document.getElementById("divAdBalloonAdsT").style.clip = "rect(0px " + window.adBallonAdT.Width + "px " + window.adBallonAdT.Height + "px 230px)"; } } else { if (window.adBallonAdB != null) { document.getElementById("divAdBalloonAdsB").style.clip = "rect(" + window.adBallonAdB.Min + "px " + window.adBallonAdB.Width + "px " + window.adBallonAdB.Height + "px " + window.adBallonAdB.Left + "px)"; } } } function setTimeDelay() { timeOutPopupVad = setTimeout("minBalloonAdsVad()", 7000); } function clearTimeDelay() { clearTimeout(timeOutPopupVad); } function WriteBug(msg) { document.getElementById('bug').innerHTML += '<br/>' + msg; } function createCookie(name, value, minutes) { if (minutes) { var date = new Date(); date.setTime(date.getTime() + (minutes * 60 * 1000)); var expires = "; expires=" + date.toGMTString(); } else var expires = ""; document.cookie = name + "=" + value + expires + "; path=/"; } function eraseCookie(name) { createCookie(name, "", -1); } function readCookie(name) { var nameEQ = name + "="; var ca = document.cookie.split(';'); for (var i = 0; i < ca.length; i++) { var c = ca[i]; while (c.charAt(0) == ' ') c = c.substring(1, c.length); if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length); } return null; }
